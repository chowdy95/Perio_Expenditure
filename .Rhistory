),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40),
legend.position = "bottom") +
labs(
y = "Total Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none") +
scale_colour_discrete(guide = "none") +
facet_wrap(~location_name, scales = "free", ncol = 2)
plot_superregion_cost
# Assess perio expenditure changes globally
global_cost_df <- perio_expenditure %>%
filter(Level == 0)
plot_global_cost <- ggplot(data = global_cost_df, aes(
x = Year, y = selected_Mean_total_billions,
group = location_name
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure (billions)",
color = "Global"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none")
plot_global_superregion <- plot_global_cost + plot_superregion_cost
plot_global_superregion
plot_global_cost <- ggplot(data = global_cost_df, aes(
x = Year, y = selected_Mean_total_billions,
group = location_name
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Global Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none")
plot_global_superregion <- plot_global_cost + plot_superregion_cost
plot_global_superregion
plot_superregion_cost <- ggplot(data = superregion_cost_df, aes(
x = Year, y = selected_Mean_total_billions
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation"), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none") +
scale_colour_discrete(guide = "none") +
facet_wrap(~location_name, scales = "free", ncol = 2)
plot_superregion_cost
# Assess perio expenditure changes globally
global_cost_df <- perio_expenditure %>%
filter(Level == 0)
plot_global_cost <- ggplot(data = global_cost_df, aes(
x = Year, y = selected_Mean_total_billions,
group = location_name
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Global Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none") +
scale_colour_discrete(guide = "none")
plot_global_superregion <- plot_global_cost + plot_superregion_cost & theme(legend.position = "bottom")
plot_global_superregion
# Assess perio expenditure changes for each superregion
superregion_cost_df <- perio_expenditure %>%
filter(Level < 2) %>%
mutate(location_name = fct_reorder(location_name, transition_WHO_selected_Mean_total_billions)) %>%
mutate(location_name = fct_rev(location_name))
plot_superregion_cost <- ggplot(data = superregion_cost_df, aes(
x = Year, y = selected_Mean_total_billions
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation"), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none") +
scale_colour_discrete(guide = "none") +
facet_wrap(~location_name, scales = "free", ncol = 2)
plot_superregion_cost
plot_superregion_cost <- ggplot(data = superregion_cost_df, aes(
x = Year, y = selected_Mean_total_billions
)) +
geom_line(aes(color = location_name, linetype = "Current dental utilisation"), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
), linewidth = 1.2) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40),
legend.position = "bottom") +
labs(
y = "Total Periodontitis Expenditure (billions)"
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
scale_fill_discrete(guide = "none") +
scale_colour_discrete(guide = "none") +
facet_wrap(~location_name, scales = "free", ncol = 2)
plot_superregion_cost
plot_superregion_cost
ggsave("outputs_forecast/patchwork_global_superregion.pdf", plot_global_superregion, width = 6, height = 8)
plot_superregion_cost
ggsave("outputs_forecast/patchwork_global_superregion.pdf", plot_global_superregion, width = 6, height = 8)
plot_superregion_cost
ggsave("outputs_forecast/patchwork_global_superregion.pdf", width = 6, height = 8)
ggsave("outputs_forecast/patchwork_global_superregion.pdf", width = 8, height = 8)
perio_expenditure_countries <- perio_expenditure %>%
filter(Level == 3)
top_10_expenditure <- perio_expenditure_countries %>%
filter(Level == 3, Year == 2050) %>%
arrange(desc(transition_WHO_selected_Mean_total_billions)) %>%
slice(1:10) %>%
select(iso3c)
top_10_expenditure_df <- perio_expenditure %>%
inner_join(top_10_expenditure, by = "iso3c") %>%
mutate(location_name = fct_reorder(location_name, transition_WHO_selected_Mean_total_billions)) %>%
mutate(location_name = fct_rev(location_name))
plot_top10_exp_cost <- ggplot(top_10_expenditure_df, aes(x = Year, y = selected_Mean_total_billions, group = location_name)) +
geom_line(data = perio_expenditure_countries, aes(x = Year, y = selected_Mean_total_billions, linetype = "Current dental utilisation"), alpha = 0.15) +
geom_line(data = top_10_expenditure_df, aes(x = Year, y = selected_Mean_total_billions, color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.1
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure (millions)",
color = "Country (top 10 for 2050 periodontitis expenditure based on WHO target) "
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
guides(fill = "none", alpha = "none")
perio_expenditure_countries <- perio_expenditure_countries %>%
mutate(
# Current scenario per capita in USD
selected_exppc_usd_mean = (selected_Mean_total_billions * 1e9) / Pop,
selected_exppc_usd_sd = sqrt(
(selected_SD_total_billions * 1e9 / Pop)^2 +
(selected_Mean_total_billions * 1e9 * Pop_sd / Pop^2)^2
),
# WHO scenario per capita in USD
WHO_exppc_usd_mean = (transition_WHO_selected_Mean_total_billions * 1e9) / Pop,
WHO_exppc_usd_sd = sqrt(
(transition_WHO_selected_SD_total_billions * 1e9 / Pop)^2 +
(transition_WHO_selected_Mean_total_billions * 1e9 * Pop_sd / Pop^2)^2
)
)
top_10_exppc <- perio_expenditure_countries %>%
filter(Level == 3, Year == 2050) %>%
arrange(desc(WHO_exppc_usd_mean)) %>%
slice(1:10) %>%
select(iso3c)
top_10_exppc_df <- perio_expenditure_countries %>%
inner_join(top_10_exppc, by = "iso3c") %>%
mutate(location_name = fct_reorder(location_name, WHO_exppc_usd_mean)) %>%
mutate(location_name = fct_rev(location_name))
plot_top10_exppc_cost <- ggplot(top_10_exppc_df, aes(x = Year, y = selected_exppc_usd_mean, group = location_name)) +
geom_line(data = perio_expenditure_countries, aes(x = Year, y = selected_exppc_usd_mean, linetype = "Current dental utilisation"), alpha = 0.15) +
geom_line(data = top_10_exppc_df, aes(x = Year, y = selected_exppc_usd_mean, color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_exppc_usd_mean - selected_exppc_usd_sd,
ymax = selected_exppc_usd_mean + selected_exppc_usd_sd, fill = location_name
),
alpha = 0.1
) +
geom_line(aes(
x = Year, y = WHO_exppc_usd_mean,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = WHO_exppc_usd_mean - WHO_exppc_usd_sd,
ymax = WHO_exppc_usd_mean + WHO_exppc_usd_sd, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure Per Capita (2025 USD)",
color = "Country (top 10 for 2050 expenditure per capita, WHO target) "
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
guides(fill = "none", alpha = "none")
plot_top10_exppc_cost
top_10_exppc_df
View(top_10_exppc_df)
colnames(top_10_exppc_df)
library(tidyverse)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(countrycode)
library(patchwork)
# Read your data
perio_expenditure <- read_csv("outputs_forecast/expenditure_summary_forecast_percapita.csv")
# Load world map & crop Antarctica
world <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf") %>%
filter(admin != "Antarctica")
# Join
map_data <- world %>%
inner_join(perio_expenditure, by = c("iso_a3_eh" = "iso3c"), relationship = "many-to-many")
map_data_2021 <- map_data %>%
filter(Year == 2021)
# Plot
map_base_2021 <- ggplot(map_data_2021) +
geom_sf(aes(fill = selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Estimated Periodontal Expenditure by Country (2021)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_2021
# Plot
map_base_2050 <- ggplot(map_data_2050) +
geom_sf(aes(fill = selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Base Scenario: Estimated Periodontal Expenditure by Country (2050)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_2050
map_data_2050 <- map_data %>%
filter(Year == 2050)
# Plot
map_base_2050 <- ggplot(map_data_2050) +
geom_sf(aes(fill = selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Base Scenario: Estimated Periodontal Expenditure by Country (2050)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_2050
map_data_2050 <- map_data %>%
filter(Year == 2050)
# Plot
map_base_2050_WHO <- ggplot(map_data_2050) +
geom_sf(aes(fill = transition_WHO_selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "WHO Target Scenario: Estimated Periodontal Expenditure by Country (2050)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_2050_WHO
perio_expenditure_wide <- read_csv("outputs_forecast/expenditure_summary_forecast_wide.csv") %>%
rename(location_name = LocationHeader) %>%
mutate(
gap_WHO_mean = WHO_selected_Mean_total_billions_2050 - selected_Mean_total_billions_2021
)
# Load world map & crop Antarctica
world <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf") %>%
filter(admin != "Antarctica")
# Join
map_data_gap <- world %>%
inner_join(perio_expenditure_wide, by = c("iso_a3_eh" = "iso3c"), relationship = "many-to-many")
# Plot
map_base_gap <- ggplot(map_data_gap) +
geom_sf(aes(fill = gap_WHO_mean * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Gap between 2021 expenditure and 2050 WHO target",
subtitle = "Countries with decrease or no change in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_gap
