# Percentage change (base)
pctchange_base_mean = ((selected_Mean_total_billions_2050 - selected_Mean_total_billions_2021) /
selected_Mean_total_billions_2021) * 100,
pctchange_base_lower = ((base_2050_lower - base_2021_upper) /
base_2021_upper) * 100,
pctchange_base_upper = ((base_2050_upper - base_2021_lower) /
base_2021_lower) * 100,
# Percentage change (WHO)
pctchange_WHO_mean = ((WHO_selected_Mean_total_billions_2050 - selected_Mean_total_billions_2021) /
selected_Mean_total_billions_2021) * 100,
pctchange_WHO_lower = ((WHO_2050_lower - base_2021_upper) /
base_2021_upper) * 100,
pctchange_WHO_upper = ((WHO_2050_upper - base_2021_lower) /
base_2021_lower) * 100
) %>%
mutate(
"2021 Expenditure" = paste0(selected_Mean_total_billions_2021, " (", base_2021_lower, "-", base_2021_upper, ")"),
"2050 Base Expenditure" = paste0(selected_Mean_total_billions_2050, " (", base_2050_lower, "-", base_2050_upper, ")"),
"2050 WHO Expenditure" = paste0(WHO_selected_Mean_total_billions_2050, " (", WHO_2050_lower, "-", WHO_2050_upper, ")"),
"Total % change 2021–2050 base scenario (95% CI)" =
paste0(round(pctchange_base_mean, 1), "% (",
round(pctchange_base_lower, 1), "–",
round(pctchange_base_upper, 1), "%)"),
"Total % change 2021–2050 WHO target (95% CI)" =
paste0(round(pctchange_WHO_mean, 1), "% (",
round(pctchange_WHO_lower, 1), "–",
round(pctchange_WHO_upper, 1), "%)")
) %>%
select(
location_name,
"2021 Expenditure",
"2050 Base Expenditure",
"Total % change 2021–2050 base scenario (95% CI)",
"2050 WHO Expenditure",
"Total % change 2021–2050 WHO target (95% CI)"
)
View(superregion_wide)
View(superregion_wide)
superregion_wide <- perio_expenditure_wide %>%
filter(is.na(Region)) %>%
select(
-c(
Region, Superregion, iso3c,
WHO_selected_Mean_total_billions_2021,
WHO_selected_SD_total_billions_2021
)
) %>%
mutate(
# Compute 95% CI bounds for each variable
base_2021_upper = selected_Mean_total_billions_2021 + 1.96 * selected_SD_total_billions_2021,
base_2021_lower = selected_Mean_total_billions_2021 - 1.96 * selected_SD_total_billions_2021,
base_2050_upper = selected_Mean_total_billions_2050 + 1.96 * selected_SD_total_billions_2050,
base_2050_lower = selected_Mean_total_billions_2050 - 1.96 * selected_SD_total_billions_2050,
WHO_2050_upper  = WHO_selected_Mean_total_billions_2050 + 1.96 * WHO_selected_SD_total_billions_2050,
WHO_2050_lower  = WHO_selected_Mean_total_billions_2050 - 1.96 * WHO_selected_SD_total_billions_2050
) %>%
mutate(across(where(is.numeric), \(x) round(x, 4))) %>%
mutate(across(where(is.numeric), \(x) ifelse(x < 0, 0.01, x))) %>%
# === Compute SEs from SDs ===
mutate(
se_2021 = selected_SD_total_billions_2021,
se_base_2050 = selected_SD_total_billions_2050,
se_WHO_2050  = WHO_selected_SD_total_billions_2050
) %>%
# === Log-ratio (delta method) for percentage change ===
mutate(
# Base scenario
ratio_base = selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_base = log(ratio_base),
se_log_ratio_base = sqrt((se_base_2050 / selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_base_lower = log_ratio_base - 1.96 * se_log_ratio_base,
log_ratio_base_upper = log_ratio_base + 1.96 * se_log_ratio_base,
pctchange_base_mean = (exp(log_ratio_base) - 1) * 100,
pctchange_base_lower = (exp(log_ratio_base_lower) - 1) * 100,
pctchange_base_upper = (exp(log_ratio_base_upper) - 1) * 100,
# WHO target scenario
ratio_WHO = WHO_selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_WHO = log(ratio_WHO),
se_log_ratio_WHO = sqrt((se_WHO_2050 / WHO_selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_WHO_lower = log_ratio_WHO - 1.96 * se_log_ratio_WHO,
log_ratio_WHO_upper = log_ratio_WHO + 1.96 * se_log_ratio_WHO,
pctchange_WHO_mean = (exp(log_ratio_WHO) - 1) * 100,
pctchange_WHO_lower = (exp(log_ratio_WHO_lower) - 1) * 100,
pctchange_WHO_upper = (exp(log_ratio_WHO_upper) - 1) * 100
) %>%
# === Formatting for table output ===
mutate(
"2021 Expenditure" = paste0(selected_Mean_total_billions_2021, " (", base_2021_lower, "-", base_2021_upper, ")"),
"2050 Base Expenditure" = paste0(selected_Mean_total_billions_2050, " (", base_2050_lower, "-", base_2050_upper, ")"),
"2050 WHO Expenditure" = paste0(WHO_selected_Mean_total_billions_2050, " (", WHO_2050_lower, "-", WHO_2050_upper, ")"),
"Total % change 2021–2050 base scenario (95% CI)" =
paste0(round(pctchange_base_mean, 1), "% (",
round(pctchange_base_lower, 1), "–",
round(pctchange_base_upper, 1), "%)"),
"Total % change 2021–2050 WHO target (95% CI)" =
paste0(round(pctchange_WHO_mean, 1), "% (",
round(pctchange_WHO_lower, 1), "–",
round(pctchange_WHO_upper, 1), "%)")
) %>%
select(
location_name,
"2021 Expenditure",
"2050 Base Expenditure",
"Total % change 2021–2050 base scenario (95% CI)",
"2050 WHO Expenditure",
"Total % change 2021–2050 WHO target (95% CI)"
)
superregion_wide <- perio_expenditure_wide %>%
filter(is.na(Region)) %>%
select(
-c(
Region, Superregion, iso3c,
WHO_selected_Mean_total_billions_2021,
WHO_selected_SD_total_billions_2021
)
) %>%
mutate(
# Compute 95% CI bounds for each variable
base_2021_upper = selected_Mean_total_billions_2021 + 1.96 * selected_SD_total_billions_2021,
base_2021_lower = selected_Mean_total_billions_2021 - 1.96 * selected_SD_total_billions_2021,
base_2050_upper = selected_Mean_total_billions_2050 + 1.96 * selected_SD_total_billions_2050,
base_2050_lower = selected_Mean_total_billions_2050 - 1.96 * selected_SD_total_billions_2050,
WHO_2050_upper  = WHO_selected_Mean_total_billions_2050 + 1.96 * WHO_selected_SD_total_billions_2050,
WHO_2050_lower  = WHO_selected_Mean_total_billions_2050 - 1.96 * WHO_selected_SD_total_billions_2050
) %>%
mutate(across(where(is.numeric), \(x) ifelse(x < 0, 0.01, x))) %>%
# === Compute SEs from SDs ===
mutate(
se_2021 = selected_SD_total_billions_2021,
se_base_2050 = selected_SD_total_billions_2050,
se_WHO_2050  = WHO_selected_SD_total_billions_2050
) %>%
# === Log-ratio (delta method) for percentage change ===
mutate(
# Base scenario
ratio_base = selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_base = log(ratio_base),
se_log_ratio_base = sqrt((se_base_2050 / selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_base_lower = log_ratio_base - 1.96 * se_log_ratio_base,
log_ratio_base_upper = log_ratio_base + 1.96 * se_log_ratio_base,
pctchange_base_mean = (exp(log_ratio_base) - 1) * 100,
pctchange_base_lower = (exp(log_ratio_base_lower) - 1) * 100,
pctchange_base_upper = (exp(log_ratio_base_upper) - 1) * 100,
# WHO target scenario
ratio_WHO = WHO_selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_WHO = log(ratio_WHO),
se_log_ratio_WHO = sqrt((se_WHO_2050 / WHO_selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_WHO_lower = log_ratio_WHO - 1.96 * se_log_ratio_WHO,
log_ratio_WHO_upper = log_ratio_WHO + 1.96 * se_log_ratio_WHO,
pctchange_WHO_mean = (exp(log_ratio_WHO) - 1) * 100,
pctchange_WHO_lower = (exp(log_ratio_WHO_lower) - 1) * 100,
pctchange_WHO_upper = (exp(log_ratio_WHO_upper) - 1) * 100
) %>%
# === Round all numeric values to 2 decimals ===
mutate(across(where(is.numeric), \(x) round(x, 2))) %>%
# === Formatting for table output ===
mutate(
"2021 Expenditure" = paste0(selected_Mean_total_billions_2021, " (", base_2021_lower, "-", base_2021_upper, ")"),
"2050 Base Expenditure" = paste0(selected_Mean_total_billions_2050, " (", base_2050_lower, "-", base_2050_upper, ")"),
"2050 WHO Expenditure" = paste0(WHO_selected_Mean_total_billions_2050, " (", WHO_2050_lower, "-", WHO_2050_upper, ")"),
"Total % change 2021–2050 base scenario (95% CI)" =
paste0(pctchange_base_mean, "% (",
pctchange_base_lower, "–",
pctchange_base_upper, "%)"),
"Total % change 2021–2050 WHO target (95% CI)" =
paste0(pctchange_WHO_mean, "% (",
pctchange_WHO_lower, "–",
pctchange_WHO_upper, "%)")
) %>%
select(
location_name,
"2021 Expenditure",
"2050 Base Expenditure",
"Total % change 2021–2050 base scenario (95% CI)",
"2050 WHO Expenditure",
"Total % change 2021–2050 WHO target (95% CI)"
)
superregion_wide <- perio_expenditure_wide %>%
filter(is.na(Region)) %>%
select(
-c(
Region, Superregion, iso3c,
WHO_selected_Mean_total_billions_2021,
WHO_selected_SD_total_billions_2021
)
) %>%
mutate(
# Compute 95% CI bounds for each variable
base_2021_upper = selected_Mean_total_billions_2021 + 1.96 * selected_SD_total_billions_2021,
base_2021_lower = selected_Mean_total_billions_2021 - 1.96 * selected_SD_total_billions_2021,
base_2050_upper = selected_Mean_total_billions_2050 + 1.96 * selected_SD_total_billions_2050,
base_2050_lower = selected_Mean_total_billions_2050 - 1.96 * selected_SD_total_billions_2050,
WHO_2050_upper  = WHO_selected_Mean_total_billions_2050 + 1.96 * WHO_selected_SD_total_billions_2050,
WHO_2050_lower  = WHO_selected_Mean_total_billions_2050 - 1.96 * WHO_selected_SD_total_billions_2050
) %>%
mutate(across(where(is.numeric), \(x) ifelse(x < 0, 0.01, x))) %>%
# === Compute SEs from SDs ===
mutate(
se_2021 = selected_SD_total_billions_2021,
se_base_2050 = selected_SD_total_billions_2050,
se_WHO_2050  = WHO_selected_SD_total_billions_2050
) %>%
# === Log-ratio (delta method) for percentage change ===
mutate(
# Base scenario
ratio_base = selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_base = log(ratio_base),
se_log_ratio_base = sqrt((se_base_2050 / selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_base_lower = log_ratio_base - 1.96 * se_log_ratio_base,
log_ratio_base_upper = log_ratio_base + 1.96 * se_log_ratio_base,
pctchange_base_mean = (exp(log_ratio_base) - 1) * 100,
pctchange_base_lower = (exp(log_ratio_base_lower) - 1) * 100,
pctchange_base_upper = (exp(log_ratio_base_upper) - 1) * 100,
# WHO target scenario
ratio_WHO = WHO_selected_Mean_total_billions_2050 / selected_Mean_total_billions_2021,
log_ratio_WHO = log(ratio_WHO),
se_log_ratio_WHO = sqrt((se_WHO_2050 / WHO_selected_Mean_total_billions_2050)^2 +
(se_2021 / selected_Mean_total_billions_2021)^2),
log_ratio_WHO_lower = log_ratio_WHO - 1.96 * se_log_ratio_WHO,
log_ratio_WHO_upper = log_ratio_WHO + 1.96 * se_log_ratio_WHO,
pctchange_WHO_mean = (exp(log_ratio_WHO) - 1) * 100,
pctchange_WHO_lower = (exp(log_ratio_WHO_lower) - 1) * 100,
pctchange_WHO_upper = (exp(log_ratio_WHO_upper) - 1) * 100
) %>%
# === Round all numeric values to 2 decimals ===
mutate(across(where(is.numeric), \(x) round(x, 1))) %>%
# === Formatting for table output ===
mutate(
"2021 Expenditure" = paste0(selected_Mean_total_billions_2021, " (", base_2021_lower, "-", base_2021_upper, ")"),
"2050 Base Expenditure" = paste0(selected_Mean_total_billions_2050, " (", base_2050_lower, "-", base_2050_upper, ")"),
"2050 WHO Expenditure" = paste0(WHO_selected_Mean_total_billions_2050, " (", WHO_2050_lower, "-", WHO_2050_upper, ")"),
"Total % change 2021–2050 base scenario (95% CI)" =
paste0(pctchange_base_mean, "% (",
pctchange_base_lower, "–",
pctchange_base_upper, "%)"),
"Total % change 2021–2050 WHO target (95% CI)" =
paste0(pctchange_WHO_mean, "% (",
pctchange_WHO_lower, "–",
pctchange_WHO_upper, "%)")
) %>%
select(
location_name,
"2021 Expenditure",
"2050 Base Expenditure",
"Total % change 2021–2050 base scenario (95% CI)",
"2050 WHO Expenditure",
"Total % change 2021–2050 WHO target (95% CI)"
)
ggsave("outputs_forecast/world_periodontal_expenditure_map_2021.png",
plot = map_base_2021,
width = 24, height = 10, dpi = 300
)
# Load libraries
library(tidyverse)
library(sf)
library(rnaturalearth)
library(rnaturalearthdata)
library(countrycode)
library(patchwork)
# Read your data
perio_expenditure <- read_csv("outputs_forecast/expenditure_summary_forecast_percapita.csv")
# Load world map & crop Antarctica
world <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf") %>%
filter(admin != "Antarctica")
# Join
map_data <- world %>%
inner_join(perio_expenditure, by = c("iso_a3_eh" = "iso3c"), relationship = "many-to-many")
map_data_2021 <- map_data %>%
filter(Year == 2021)
# Plot
map_base_2021 <- ggplot(map_data_2021) +
geom_sf(aes(fill = selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Estimated Periodontal Expenditure by Country (2021)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_base_2021
ggsave("outputs_forecast/world_periodontal_expenditure_map_2021.png",
plot = map_base_2021,
width = 24, height = 10, dpi = 300
)
map_data_2050 <- map_data %>%
filter(Year == 2050)
# Plot
map_base_2050 <- ggplot(map_data_2050) +
geom_sf(aes(fill = selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Base Scenario: Estimated Periodontal Expenditure by Country (2050)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
map_data_2050 <- map_data %>%
filter(Year == 2050)
# Plot
map_base_2050_WHO <- ggplot(map_data_2050) +
geom_sf(aes(fill = transition_WHO_selected_Mean_total_billions * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "WHO Target Scenario: Estimated Periodontal Expenditure by Country (2050)",
subtitle = "Countries with no data shown in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
perio_expenditure_wide <- read_csv("outputs_forecast/expenditure_summary_forecast_wide.csv") %>%
rename(location_name = LocationHeader) %>%
mutate(
gap_WHO_mean = WHO_selected_Mean_total_billions_2050 - selected_Mean_total_billions_2021
)
# Load world map & crop Antarctica
world <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf") %>%
filter(admin != "Antarctica")
# Join
map_data_gap <- world %>%
inner_join(perio_expenditure_wide, by = c("iso_a3_eh" = "iso3c"), relationship = "many-to-many")
# Plot
map_base_gap <- ggplot(map_data_gap) +
geom_sf(aes(fill = gap_WHO_mean * 1000)) + # billions → millions
scale_fill_viridis_c(
trans = "log10",
option = "plasma",
begin = 0.15, # skew lighter: higher begin shifts scale lighter
end = 1,
direction = -1, # higher = darker
breaks = scales::trans_breaks("log10", function(x) 10^x),
limits = c(1e-1, 1e5),
labels = scales::comma_format(suffix = "M", scale = 1),
na.value = "grey80",
name = "Periodontal Expenditure (Millions USD)"
) +
labs(
title = "Gap between 2021 expenditure and 2050 WHO target",
subtitle = "Countries with decrease or no change in grey"
) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
plot.subtitle = element_text(hjust = 0.5),
legend.position = "right"
)
plot_patchwork_map <- (map_base_2050 + map_base_2050_WHO + map_base_gap) +
plot_layout(ncol = 1, nrow = 3) +
plot_annotation(tag_levels = "A")
plot_patchwork_map
ggsave("outputs_forecast/world_periodontal_expenditure_map_2021_2025.png",
plot = plot_patchwork_map,
width = 12, height = 30, dpi = 300
)
ggsave("outputs_forecast/world_periodontal_expenditure_map_2021_2025.png",
plot = plot_patchwork_map,
width = 18, height = 20, dpi = 300
)
perio_expenditure_countries <- perio_expenditure %>%
filter(Level == 3)
top_10_expenditure <- perio_expenditure_countries %>%
filter(Level == 3, Year == 2050) %>%
arrange(desc(transition_WHO_selected_Mean_total_billions)) %>%
slice(1:5) %>%
select(iso3c)
top_10_expenditure_df <- perio_expenditure %>%
inner_join(top_10_expenditure, by = "iso3c") %>%
mutate(location_name = fct_reorder(location_name, transition_WHO_selected_Mean_total_billions)) %>%
mutate(location_name = fct_rev(location_name))
plot_top10_exp_cost <- ggplot(top_10_expenditure_df, aes(x = Year, y = selected_Mean_total_billions, group = location_name)) +
geom_line(data = perio_expenditure_countries, aes(x = Year, y = selected_Mean_total_billions, linetype = "Current dental utilisation"), alpha = 0.15) +
geom_line(data = top_10_expenditure_df, aes(x = Year, y = selected_Mean_total_billions, color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_Mean_total_billions - selected_SD_total_billions,
ymax = selected_Mean_total_billions + selected_SD_total_billions, fill = location_name
),
alpha = 0.1
) +
geom_line(aes(
x = Year, y = transition_WHO_selected_Mean_total_billions,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = transition_WHO_selected_Mean_total_billions - transition_WHO_selected_SD_total_billions,
ymax = transition_WHO_selected_Mean_total_billions + transition_WHO_selected_SD_total_billions, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure (millions)",
color = "Country (top 5 for 2050 periodontitis expenditure based on WHO target) "
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
guides(fill = "none", alpha = "none")
plot_top10_exp_cost
perio_expenditure_countries <- perio_expenditure_countries %>%
mutate(
# Current scenario per capita in USD
selected_exppc_usd_mean = (selected_Mean_total_billions * 1e9) / Pop,
selected_exppc_usd_sd = sqrt(
(selected_SD_total_billions * 1e9 / Pop)^2 +
(selected_Mean_total_billions * 1e9 * Pop_sd / Pop^2)^2
),
# WHO scenario per capita in USD
WHO_exppc_usd_mean = (transition_WHO_selected_Mean_total_billions * 1e9) / Pop,
WHO_exppc_usd_sd = sqrt(
(transition_WHO_selected_SD_total_billions * 1e9 / Pop)^2 +
(transition_WHO_selected_Mean_total_billions * 1e9 * Pop_sd / Pop^2)^2
)
)
top_10_exppc <- perio_expenditure_countries %>%
filter(Level == 3, Year == 2050) %>%
arrange(desc(WHO_exppc_usd_mean)) %>%
slice(1:5) %>%
select(iso3c)
top_10_exppc_df <- perio_expenditure_countries %>%
inner_join(top_10_exppc, by = "iso3c") %>%
mutate(location_name = fct_reorder(location_name, WHO_exppc_usd_mean)) %>%
mutate(location_name = fct_rev(location_name))
plot_top10_exppc_cost <- ggplot(top_10_exppc_df, aes(x = Year, y = selected_exppc_usd_mean, group = location_name)) +
geom_line(data = perio_expenditure_countries, aes(x = Year, y = selected_exppc_usd_mean, linetype = "Current dental utilisation"), alpha = 0.15) +
geom_line(data = top_10_exppc_df, aes(x = Year, y = selected_exppc_usd_mean, color = location_name, linetype = "Current dental utilisation")) +
geom_ribbon(
aes(
ymin = selected_exppc_usd_mean - selected_exppc_usd_sd,
ymax = selected_exppc_usd_mean + selected_exppc_usd_sd, fill = location_name
),
alpha = 0.1
) +
geom_line(aes(
x = Year, y = WHO_exppc_usd_mean,
color = location_name, linetype = "WHO target of 80% coverage"
)) +
geom_ribbon(
aes(
ymin = WHO_exppc_usd_mean - WHO_exppc_usd_sd,
ymax = WHO_exppc_usd_mean + WHO_exppc_usd_sd, fill = location_name
),
alpha = 0.05
) +
theme_minimal() +
theme(plot.margin = margin(t = 30, r = 40, b = 20, l = 40)) +
labs(
y = "Total Periodontitis Expenditure Per Capita (2025 USD)",
color = "Country (top 5 for 2050 expenditure per capita, WHO target) "
) +
scale_linetype_manual(
values = c("Current dental utilisation" = "solid", "WHO target of 80% coverage" = "dashed"),
name = "Dental utilisation scenario"
) +
guides(fill = "none", alpha = "none")
plot_countries_expenditure <- plot_top10_exp_cost + plot_top10_exppc_cost + plot_annotation(tag_levels = "A")
plot_countries_expenditure <- plot_top10_exp_cost + plot_top10_exppc_cost +
plot_annotation(tag_levels = "A")  +
plot_layout(ncol = 1, nrow = 2)
ggsave("outputs_forecast/patchwork_countries_expenditure.png", plot_countries_expenditure, width = 18, height = 12, dpi = 300)
ggsave("outputs_forecast/patchwork_countries_expenditure.png", plot_countries_expenditure, width = 15, height = 12, dpi = 300)
